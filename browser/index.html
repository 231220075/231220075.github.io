extends includes/layout.pug

block content
    .browser-container
        .browser-header
            .browser-controls
                .browser-buttons
                    span.close
                    span.minimize
                    span.maximize
                .browser-url-bar
                    input(type="url" id="urlInput" placeholder="输入网址..." value="https://www.baidu.com")
                    button(id="goButton") 访问
                    button(id="refreshButton") 刷新
                .browser-nav
                    button(id="backButton") ←
                    button(id="forwardButton") →
                    button(id="homeButton") 🏠
        .browser-content
            iframe(id="browserFrame" src="https://www.baidu.com" frameborder="0")
        
        .quick-links
            h3 快速访问
            .quick-buttons
                button.quick-btn(data-url="https://www.baidu.com") 百度
                button.quick-btn(data-url="https://www.google.com") Google
                button.quick-btn(data-url="https://github.com") GitHub
                button.quick-btn(data-url="https://stackoverflow.com") Stack Overflow
                button.quick-btn(data-url="https://developer.mozilla.org") MDN
                button.quick-btn(data-url="https://www.bilibili.com") 哔哩哔哩
                button.quick-btn(data-url="https://www.youtube.com") YouTube
                button.quick-btn(data-url="https://www.netflix.com") Netflix

    style.
        .browser-container {
            max-width: 100%;
            margin: 0 auto;
            background: #f5f5f5;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        .browser-header {
            background: #e8e8e8;
            padding: 10px;
            border-bottom: 1px solid #ccc;
        }

        .browser-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .browser-buttons {
            display: flex;
            gap: 8px;
        }

        .browser-buttons span {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            cursor: pointer;
        }

        .close { background: #ff5f57; }
        .minimize { background: #ffbd2e; }
        .maximize { background: #28ca42; }

        .browser-url-bar {
            flex: 1;
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .browser-url-bar input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #ccc;
            border-radius: 20px;
            outline: none;
            font-size: 14px;
        }

        .browser-url-bar button {
            padding: 8px 15px;
            border: none;
            background: #007AFF;
            color: white;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
        }

        .browser-url-bar button:hover {
            background: #0056CC;
        }

        .browser-nav {
            display: flex;
            gap: 5px;
        }

        .browser-nav button {
            width: 35px;
            height: 35px;
            border: none;
            background: #007AFF;
            color: white;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }

        .browser-nav button:hover {
            background: #0056CC;
        }

        .browser-content {
            height: 600px;
            background: white;
        }

        .browser-content iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        .quick-links {
            background: #f9f9f9;
            padding: 15px;
            border-top: 1px solid #ddd;
        }

        .quick-links h3 {
            margin: 0 0 10px 0;
            font-size: 16px;
            color: #333;
        }

        .quick-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .quick-btn {
            padding: 8px 16px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 20px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s;
        }

        .quick-btn:hover {
            background: #007AFF;
            color: white;
            border-color: #007AFF;
        }

        @media (max-width: 768px) {
            .browser-controls {
                flex-direction: column;
                gap: 8px;
            }
            
            .browser-content {
                height: 400px;
            }
            
            .quick-buttons {
                justify-content: center;
            }
        }

        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100%;
            font-size: 18px;
            color: #666;
        }

    script.
        document.addEventListener('DOMContentLoaded', function() {
            const urlInput = document.getElementById('urlInput');
            const goButton = document.getElementById('goButton');
            const refreshButton = document.getElementById('refreshButton');
            const backButton = document.getElementById('backButton');
            const forwardButton = document.getElementById('forwardButton');
            const homeButton = document.getElementById('homeButton');
            const browserFrame = document.getElementById('browserFrame');
            const quickButtons = document.querySelectorAll('.quick-btn');
            
            let history = ['https://www.baidu.com'];
            let currentIndex = 0;
            
            function loadUrl(url) {
                // 确保URL有协议
                if (!url.startsWith('http://') && !url.startsWith('https://')) {
                    url = 'https://' + url;
                }
                
                try {
                    browserFrame.src = url;
                    urlInput.value = url;
                    
                    // 更新历史记录
                    if (history[currentIndex] !== url) {
                        currentIndex++;
                        history = history.slice(0, currentIndex);
                        history.push(url);
                    }
                    
                    updateNavButtons();
                } catch (error) {
                    console.error('无法加载URL:', error);
                    alert('无法加载该网站，可能存在跨域限制');
                }
            }
            
            function updateNavButtons() {
                backButton.disabled = currentIndex <= 0;
                forwardButton.disabled = currentIndex >= history.length - 1;
            }
            
            // 访问按钮
            goButton.addEventListener('click', function() {
                const url = urlInput.value.trim();
                if (url) {
                    loadUrl(url);
                }
            });
            
            // 回车键访问
            urlInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    goButton.click();
                }
            });
            
            // 刷新按钮
            refreshButton.addEventListener('click', function() {
                browserFrame.src = browserFrame.src;
            });
            
            // 后退按钮
            backButton.addEventListener('click', function() {
                if (currentIndex > 0) {
                    currentIndex--;
                    const url = history[currentIndex];
                    browserFrame.src = url;
                    urlInput.value = url;
                    updateNavButtons();
                }
            });
            
            // 前进按钮
            forwardButton.addEventListener('click', function() {
                if (currentIndex < history.length - 1) {
                    currentIndex++;
                    const url = history[currentIndex];
                    browserFrame.src = url;
                    urlInput.value = url;
                    updateNavButtons();
                }
            });
            
            // 首页按钮
            homeButton.addEventListener('click', function() {
                loadUrl('https://www.baidu.com');
            });
            
            // 快速访问按钮
            quickButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const url = this.getAttribute('data-url');
                    loadUrl(url);
                });
            });
            
            // iframe 加载事件
            browserFrame.addEventListener('load', function() {
                console.log('页面加载完成');
            });
            
            // 初始化导航按钮状态
            updateNavButtons();
            
            // 添加加载状态
            browserFrame.addEventListener('loadstart', function() {
                console.log('开始加载...');
            });
        });
